# 產品需求文件 (PRD): PCM (專業營建管理) - 第一階段

## 1. 目標與背景情境 (Goals and Background Context)

### 目標 (Goals)
本專案旨在達成以下使用者與業務成果：
* **系統整合**: 將現有的 PCM、iPhoto、ESH 三個獨立系統的功能，全部移轉並整合至一個全新的、統一的現代化平台。
* **提升效率**: 系統上線後三個月內，將專案經理手動彙整日報/週報的時間減少 50%。
* **強化風控**: 透過即時的數據儀表板，讓管理者能更早發現問題，目標是將因資訊延遲而造成的專案延誤事件降低 15%。
* **流程數位化**: 系統上線後一個月內，取代 90% 以電子郵件或通訊軟體進行的廠商日報提交流程。
* **改善使用者體驗**: 讓專案經理、工地主任及品管人員等核心使用者，能在極短時間內（5-15分鐘）完成其每日關鍵任務。
* **高採用率**: 專案導入後兩個月內，達到 80% 的註冊成員每週至少登入使用一次。

### 背景情境 (Background Context)
當前大型營建專案的管理流程不僅高度依賴如 Excel、電子郵件等多種零散工具，更分散於三個核心但老舊的獨立系統（PCM、iPhoto、ESH）中，導致了嚴重的資訊孤島效應。這不僅造成溝通效率低落、決策延遲，更直接影響專案的時程、成本與品質控管。

為了解決這些痛點，本專案旨在打造一個全新的「PCM」網頁應用程式，作為營建專案的「單一事實來源」(Single Source of Truth)。它不僅要提供創新的管理功能，更重要的使命是承接並整合舊有三大系統的核心職能，徹底解決系統分散的問題。它將透過角色驅動的儀表板、嚴謹的變更管理流程，以及為營建業量身訂做的專業模組，來徹底改變現有的工作模式，提升整體專案的效率、透明度與成功率。

### 變更日誌 (Change Log)
| 日期 | 版本 | 描述 | 作者 |
| :--- | :--- | :--- | :--- |
| 2025-09-08 | 1.1 | 新增系統整合的總體目標 | John (PM) |
| 2025-09-08 | 1.0 | 初始版本建立 | John (PM) |

## 2. 需求 (Requirements) - 第一階段

### 功能性需求 (Functional Requirements)
* **FR1**: 系統必須提供使用者登入、登出及會話管理功能。
* **FR2**: 使用者登入後，系統應根據其權限顯示可存取的專案列表，並允許其選擇進入特定專案。
* **FR3**: 系統必須提供一個介面，用於建立、編輯和刪除階層式的 WBS (工作分解結構) 項目，並支援收闔與展開顯示。
* **FR4**: 系統必須包含廠商人員通訊錄功能，允許新增、查詢、修改、刪除廠商及人員聯絡資訊。
* **FR5**: 系統應提供一個日曆視圖，用於查詢及設定廠商人員的值班表。
* **FR6**: 系統需能接收並統計來自刷卡機 API 的每日出勤數據，並按不同機能（如土建/機電）產生統計報表與圖表。
* **FR7**: 系統需提供介面，讓協力廠商與專案人員能以日/週為單位提交報告並上傳附件。
* **FR8**: 系統需提供最新消息發布與管理功能。
* **FR9**: 系統必須根據使用者角色（至少包含專案經理與品管人員）顯示不同的儀表板佈局與數據內容。
* **FR10**: 系統必須包含一個建立測試用種子資料的腳本或程序，以便在沒有正式資料時進行開發測試。

### 非功能性需求 (Non-Functional Requirements)
* **NFR1**: 系統所有功能都必須以**繁體中文**為主要顯示語言。
* **NFR2**: 系統必須能夠在 **Docker 容器**中運行，並部署於地端虛擬化環境。
* **NFR3**: 系統後端資料庫必須使用 **Oracle**。
* **NFR4**: 系統應採用響應式網頁設計 (RWD)，確保在桌面、平板和行動裝置上都有一致且良好的使用者體驗。
* **NFR5**: 系統應具備足夠的安全性，保護使用者身份驗證資訊與專案資料，防止未經授權的存取。
* **NFR6**: 系統核心功能在正常操作下的回應時間不應超過 3 秒。

## 3. 使用者介面設計目標 (User Interface Design Goals)

### 整體UX願景 (Overall UX Vision)
打造一個**清晰、高效、可靠**的專業工具。介面應直觀易用，讓使用者能以最少的點擊次數完成關鍵任務。我們追求的是專業感與信賴感，而非華麗的視覺效果。

### 關鍵互動模式 (Key Interaction Paradigms)
* **儀表板為核心**: 使用者的起始點與資訊中心永遠是儀表板，所有操作都由此展開。
* **任務導向**: 所有的表單與資料輸入介面（如提交日報）都將被優化，以便快速、準確地輸入資訊。
* **數據驅動**: 所有的圖表與視覺化元素（如日曆、統計圖）都必須一目了然，幫助使用者快速判讀資訊。
* **跨平台響應式設計**: 確保介面在桌面(PC)與行動裝置上都提供完整且流暢的操作體驗。

### 核心畫面與視圖 (Core Screens and Views) - 第一階段
* 登入頁
* 專案選擇頁
* 主儀表板 (需具備根據專案經理/品管人員角色切換不同視圖的能力)
* WBS 設定頁
* 人員管理 (包含通訊錄與值班表)
* 廠商/人員日報提交頁 (包含檔案上傳功能)

### 無障礙設計 (Accessibility)
建議遵循 **WCAG AA** 標準，確保系統對於所有使用者都是可用且易於操作的。

### 品牌形象 (Branding)
**視覺風格與色系**: 整體視覺風格應參照使用者提供的設計稿 (`image_56d6b-8.jpg`)。關鍵元素如下：
* **主色調**: 以專業、沉穩的**綠色**作為進度條、狀態標籤等核心互動元素的主色調。
* **狀態色**: 使用不同的顏色清晰標示狀態，例如綠色代表「進行中」，紅色/橘色代表「已逾期」，灰色代表「已完成」。
* **版面配置**: 採用乾淨、簡潔的卡片式佈局，並善用留白，創造專業且易於閱讀的介面。
* **基礎**: 整體風格與 `shadcn/ui` 元件庫的簡潔美學保持一致，並在此基礎上套用上述的品牌色系。

### 目標裝置與平台 (Target Device and Platforms)
**響應式網站 (Web Responsive)**，需良好支援桌面、平板與手機瀏覽器。

## 4. 史詩與故事 (Epics & Stories) - 第一階段

### 史詩 1：基礎建設與核心框架 (Foundation & Core Framework)
**擴充目標**: 此史詩的目標是完成所有前置的技術準備工作，為後續的業務功能開發鋪路。這包括建立可重複執行的開發環境 (Docker)，連接到 Oracle 資料庫，並實作最基本的使用者登入與專案選擇流程。完成此史詩後，我們的應用程式將在技術上「啟動並運行」，並準備好承載真正的業務邏輯。

* **使用者故事 1.1：專案初始化與 Docker 環境建置**
    * **身為** 開發者, **我想要** 設定一個新的 Next.js Monorepo 專案並配置好 Docker, **以便** 整個團隊能擁有一個一致的本地開發環境。
    * **驗收標準**: 1. Monorepo 專案結構被建立。 2. Next.js 應用程式被初始化。 3. `docker-compose.yml` 建立並可成功啟動 Next.js 與 Oracle 服務。 4. 基礎程式碼風格工具已配置。
* **使用者故事 1.2 (新版)：建立測試用的種子資料**
    * **身為** 開發者, **我想要** 建立一個腳本，能在新的 Oracle 資料庫中植入測試用的假資料, **以便** 後續功能在沒有正式資料時也能被開發與測試。
    * **驗收標準**: 1. 「種子資料」腳本被建立。 2. 執行腳本後，使用者、專案等資料表會被填入樣本資料。 3. 樣本資料足以讓後續的登入與專案選擇功能正常運作。
* **使用者故事 1.3：使用者身份驗證**
    * **身為** 專案成員, **我想要** 使用我的帳號密碼登入系統, **以便** 安全地存取 PCM 平台。
    * **驗收標準**: 1. 提供登入頁面。 2. 提交後會呼叫後端 API 驗證。 3. 根據 Oracle 中的資料核對憑證。 4. 成功登入後建立安全會話。 5. 失敗時顯示錯誤訊息。 6. 提供登出功能。
* **使用者故事 1.4：專案選擇頁面**
    * **身為** 已登入的使用者, **我想要** 看到我有權限存取的專案列表, **以便** 我可以選擇要進入的專案。
    * **驗收標準**: 1. 登入後導向專案選擇頁。 2. 以卡片形式顯示專案列表。 3. 根據使用者權限顯示專案。 4. 卡片上顯示關鍵資訊。 5. 點擊卡片後能導向主儀表板。

### 史詩 2：人員與權限管理 (Personnel & Permissions Management)
**擴充目標**: 此史詩的目標是建構一套完整的系統，用以管理所有參與專案的協力廠商及其下的人員。同時，我們將建立後端的角色與權限系統，這是實現「角色化儀表板」與確保資料安全的基礎。完成此史詩後，管理者將能夠在系統中建立與管理所有使用者。

* **使用者故事 2.1：廠商與人員通訊錄管理介面**
    * **身為** 管理者, **我想要** 一個使用者介面來管理協力廠商及其人員資料, **以便** 我能擁有一個中央通訊錄。
    * **驗收標準**: 1. 提供人員管理頁面。 2. 可新增協力廠商。 3. 可在協力廠商下新增人員。 4. 資料以可搜尋的列表呈現。 5. 提供編輯與刪除功能。
* **使用者故事 2.2：角色與權限系統後端建置**
    * **身為** 開發者, **我想要** 建立管理使用者角色與權限的資料庫結構及後端 API, **以便** 系統能控制不同使用者的操作。
    * **驗收標準**: 1. 建立 `Roles`, `Permissions` 相關資料表。 2. 提供指派角色的 API。 3. 提供檢查權限的 API。 4. 預設至少三種角色 (PM, QC, Supervisor)。
* **使用者故事 2.3：人員值班表管理**
    * **身為** 專案經理, **我想要** 一個日曆介面來管理人員值班表, **以便** 隨時知道誰在值班。
    * **驗收標準**: 1. 提供含日曆元件的值班表頁面。 2. 可從通訊錄選擇人員並指派到日期。 3. 日曆上清晰顯示值班人員。 4. 資料儲存至資料庫。
* **使用者故事 2.4：刷卡機出勤數據接收 API**
    * **身為** 系統, **我想要** 提供一個安全的 API 端點來接收出勤數據, **以便** 後續能進行工時統計。
    * **驗收標準**: 1. 建立 `POST /api/attendance` 端點。 2. API 需要認證。 3. API 能接收指定的資料格式。 4. 數據驗證後儲存至資料庫。

### 史詩 3：核心專案設定與回報機制 (Core Project Setup & Reporting Mechanism)
**擴充目標**: 此史詩的目標是實作第一批核心業務功能。我們將建立具備變更追蹤的 WBS 管理工具，以及每日回報系統。最後，我們會將這些數據呈現在初步的角色化儀表板上，完成第一階段 MVP 的交付。

* **使用者故事 3.1：WBS 工作分解結構管理**
    * **身為** 專案經理, **我想要** 一個介面來管理專案的 WBS, **以便** 我能定義完整的專案範疇。
    * **驗收標準**: 1. 提供 WBS 管理頁面。 2. 可新增、編輯、刪除階層式 WBS 項目。 3. 支援拖拉排序。 4. 所有對已儲存項目的修改都會被記錄在 audit log 中。 5. 後端 API 支援以上操作。
* **使用者故事 3.2：每日/每週報告提交功能**
    * **身為** 工地主任或協力廠商人員, **我想要** 一個簡易的表單來提交報告並上傳附件, **以便** 我能高效地回報進度。
    * **驗收標準**: 1. 提供報告提交介面。 2. 表單包含必要欄位。 3. 包含檔案上傳功能。 4. 提交的報告與附件會儲存至系統。 5. 介面支援 RWD。
* **使用者故事 3.3：最新消息公告管理**
    * **身為** 管理者, **我想要** 一個介面來發布與管理公告, **以便** 我能傳達重要資訊。
    * **驗收標準**: 1. 提供簡易編輯器。 2. 管理者可增刪改查公告。 3. 公告儲存至資料庫。
* **使用者故事 3.4：儀表板初步實作**
    * **身為** 專案經理或品管人員, **我想要** 在儀表板上看到與我角色相關的數據, **以便** 快速掌握狀況。
    * **驗收標準**: 1. 建立主儀表板頁面。 2. 系統根據角色顯示不同內容。 3. PM 角色能看到「時程摘要」與「每日工時」。 4. QC 角色能看到「品質稽核文件摘要」。 5. 儀表板顯示最新公告。